{% extends 'base/_base.html' %}
{% block content %}
{% load humanize %}
<style type="">
    tr:nth-of-type(odd) { background-color: #eee; }
    tr:nth-of-type(even) { background-color: #fff; }
    tr>td:hover { background-color: lightblue; }
    .datepicker table tr td.day:hover { background-color: lightblue; }
    /*td, th { padding: 6px; border: 1px solid #eee; text-align: left; }*/
    /*.btn { border-radius: 20px; width: 160px; outline: none; background-color: #e8e7e7; border-width: medium; border-color: #3385ff; color: black; right: 0;*/
    a.active.nav-link { background-color: #3385ff !important; border: none !important; font-weight: bold !important; color: black !important; }
    a.nav-link.last_tab { border: solid gray 1px !important; }
    .newOrderBtn { width: 160px; height: 42px; position: absolute; margin: 4px 18px; right: 0; }
    .badge { background-color: gray; color: black; font-size: 15px; margin-left: 4px; }
    .btn:hover { color: black; font-weight: bold; }
    .last_nav_item { border: none !important; }
    .nav-link:hover { background-color: #3385ff; color: black; border: none !important;}
    .nav-item { width: 14%; border-bottom: solid gray 1px; }
    .nav-tabs { margin-top: 104px; border: none !important; background-color: black; position: fixed; width: 94%; padding-top: 6px;}
    .nav-link { background-color: black; color: #1071e8; width: 90%; font-size: 1rem; padding: none; border: solid gray 1px !important; border-bottom: none !important; }
    .order_table_th { background: gray; font-weight: bold; }
    .static_label { position: fixed; display: inline-flex; min-width: calc(100vw - 160px); background-color: black; padding-bottom: 8px; margin-top: 51px; top: 0; z-index: 2; }
    .tab-content { margin-top: 156px; background-color: black !important }
    .tab-pane { margin-top: 0; }
    .table_set { margin-top: 0; padding-bottom: 1px; }
    #datepicker1 { margin: 6px 0 0 580px; width: 20%; }
    #order_search_input { width: 30%; padding-left: 10px; vertical-align: top; color: black; position: absolute; right: 0; margin: 6px 200px 0 20px; }
    #orders_label { margin: 0px 0px 10px 20px; color: #3385ff; font-size: 30px; }
    #mobile_order_search_input { display: none; }



    @media only screen and (max-width: 870px) {
        table, thead, tbody, th, td, tr { display: block; }
        thead tr { position: absolute; top: -9999px; left: -9999px; }
        tr { border: 1px solid #eee; }
        tr:nth-of-type(odd) { background: #bfbfbf; }
        td { /* Behave  like a "row" */ border: none; border-bottom: 1px solid #ccc; position: relative; padding-left: 50%; }
        td:before { /* Now like a table header */ position: absolute; /* Top/left values mimic padding */ top: 6px; left: 6px; width: 45%; padding-right: 10px; white-space: nowrap; }
        /* Label the data */
        td:nth-of-type(1):before { content: "Order Number:"; }
        td:nth-of-type(2):before { content: "Customer:"; }
        .btn { border-radius: 10px; font-size: 10px; font-weight: bold; margin: 2px; width: auto; }
        .data_row { margin-bottom: 10px; }
        .static_label { margin: 46px 0 0; min-width: calc(100vw - 20px); }
        .table { }
        .table_set { margin-top: 90px; }
        .transform-media { padding-left: 120px; }
        #orders_label { margin: 5px; color: #3385ff; font-size: 20px; }
        #order_search_input { display: none; }
        #mobile_order_search_input {color: black; width: 60%; height: 28px; margin: 5px 38px; padding-left: 10px; display: block; border-radius: 4px; border-width: 1px;  background-color: #e8e7e7; font-size: 12px; }
    }

    @media only screen and (max-width: 480px) {
        .btn { border-radius: 10px; font-size: 10px; font-weight: bold; margin: 28px 0; top: 0; width: auto; }
        .static_label { display: block; margin: 46px 0 0; min-height: 70px; min-width: calc(100vw - 20px); }
        .table_set { margin-top: 110px; }
        #orders_label { margin: 5px; color: #3385ff; font-size: 20px; height: 20px; }
        #mobile_order_search_input { width: 70%; margin: 5px 0 0 0; }
    }
</style>

<div class="static_label">
    <h2 id="orders_label">Orders</h2>
    <input class="form-control" id="datepicker1" placeholder="Select Date" type="text" style="float: right;">
    <input class="form-control" type="text" name="mobile_order_search" placeholder="Search by Order Number or Company Name" id="mobile_order_search_input">
    <input class="form-control" type="text" name="order_search" placeholder="Search by Order Number or Company Name" id="order_search_input">
    <a href="{% url 'order_add' %}" role="button" class="btn btn-primary newOrderBtn">New Order</a>
</div>
<ul class="nav nav-tabs">
    {% if today == current_week_dates.0 %}
        <li class="nav-item"><a class="nav-link active" href="#sun" data-toggle="tab">Sunday - {{ current_week_dates.0 }}<span class="badge">{{ current_week_orders.0.count }}</span></a></li>
    {% else %}
        <li class="nav-item"><a class="nav-link" href="#sun" data-toggle="tab">Sunday - {{ current_week_dates.0 }}<span class="badge">{{ current_week_orders.0.count }}</span></a></li>
    {% endif %}
    {% if today == current_week_dates.1 %}
        <li class="nav-item"><a class="nav-link active" href="#mon" data-toggle="tab">Monday - {{ current_week_dates.1 }}<span class="badge">{{ current_week_orders.1.count }}</span></a></li>
    {% else %}
        <li class="nav-item"><a class="nav-link" href="#mon" data-toggle="tab">Monday - {{ current_week_dates.1 }}<span class="badge">{{ current_week_orders.1.count }}</span></a></li>
    {% endif %}
    {% if today == current_week_dates.2 %}
        <li class="nav-item"><a class="nav-link active" href="#tue" data-toggle="tab">Tuesday - {{ current_week_dates.2 }}<span class="badge">{{ current_week_orders.2.count }}</span></a></li>
    {% else %}
        <li class="nav-item"><a class="nav-link" href="#tue" data-toggle="tab">Tuesday - {{ current_week_dates.2 }}<span class="badge">{{ current_week_orders.2.count }}</span></a></li>
    {% endif %}
    {% if today == current_week_dates.3 %}
        <li class="nav-item"><a class="nav-link active" href="#wed" data-toggle="tab">Wednesday - {{ current_week_dates.3 }}<span class="badge">{{ current_week_orders.3.count }}</span></a></li>
    {% else %}
        <li class="nav-item"><a class="nav-link" href="#wed" data-toggle="tab">Wednesday - {{ current_week_dates.3 }}<span class="badge">{{ current_week_orders.3.count }}</span></a></li>
    {% endif %}
    {% if today == current_week_dates.4 %}
        <li class="nav-item"><a class="nav-link active" href="#thu" data-toggle="tab">Thursday - {{ current_week_dates.4 }}<span class="badge">{{ current_week_orders.4.count }}</span></a></li>
    {% else %}
        <li class="nav-item"><a class="nav-link" href="#thu" data-toggle="tab">Thursday - {{ current_week_dates.4 }}<span class="badge">{{ current_week_orders.4.count }}</span></a></li>
    {% endif %}
    {% if today == current_week_dates.5 %}
        <li class="nav-item"><a class="nav-link active" href="#fri" data-toggle="tab">Friday - {{ current_week_dates.5 }}<span class="badge">{{ current_week_orders.5.count }}</span></a></li>
    {% else %}
        <li class="nav-item"><a class="nav-link" href="#fri" data-toggle="tab">Friday - {{ current_week_dates.5 }}<span class="badge">{{ current_week_orders.5.count }}</span></a></li>
    {% endif %}
    {% if today == current_week_dates.6 %}
        <li class="nav-item"><a class="nav-link active" href="#sat" data-toggle="tab">Saturday - {{ current_week_dates.6 }}<span class="badge">{{ current_week_orders.6.count }}</span></a></li>
    {% else %}
        <li class="nav-item last_nav_item"><a class="nav-link last_tab" href="#sat" data-toggle="tab">Saturday - {{ current_week_dates.6 }}<span class="badge">{{ current_week_orders.6.count }}</span></a></li>
    {% endif %}
</ul>
<form method="POST" style="display: none;" id="new_date_form">
    {% csrf_token %}
    <input id="new_date" name="new_date" type="text" value="" />
</form>

<div class="tab-content">
    <div class="tab-pane" id="sun">
        <div class="table_set">
            {% if current_week_orders.0.count > 0 %}
                <table class="table">
                    <thead>
                        <tr>
                            <th class="order_table_th" style="width: 40%;">Name</th>
                            <th class="order_table_th" style="width: 10%;">Type</th>
                            <th class="order_table_th" style="width: 20%;">Item</th>
                            <th class="order_table_th" style="width: 20%;">Quantity</th>
                            <th class="order_table_th" style="width: 10%;">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in current_week_orders.0 %}
                            {% if order.items.count > 1 %}
                                <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                    <td><div class="transform-media">{{ order.customer }}</div></td>
                                    <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.item }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.item }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td><div class="transform-media">{{ order.status }}</div></td>
                                </tr>
                            {% else %}
                                {% for item in order.items.all%}
                                    <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                        <td><div class="transform-media">{{ order.customer }}</div></td>
                                        <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                        <td><div class="transform-media">{{ item.item }}</div></td>
                                        <td><div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        <td><div class="transform-media">{{ order.status }}</div></td>
                                    </tr>
                                {% endfor %}
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
   </div>
   <div class="tab-pane" id="mon">
        <div class="table_set">
            {% if current_week_orders.1.count > 0 %}
                <table class="table">
                    <thead>
                        <tr>
                            <th class="order_table_th" style="width: 40%;">Name</th>
                            <th class="order_table_th" style="width: 10%;">Type</th>
                            <th class="order_table_th" style="width: 20%;">Item</th>
                            <th class="order_table_th" style="width: 20%;">Quantity</th>
                            <th class="order_table_th" style="width: 10%;">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in current_week_orders.1 %}
                            {% if order.items.count > 1 %}
                                <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                    <td><div class="transform-media">{{ order.customer }}</div></td>
                                    <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.item }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.item }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td><div class="transform-media">{{ order.status }}</div></td>
                                </tr>
                            {% else %}
                                {% for item in order.items.all%}
                                    <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                        <td><div class="transform-media">{{ order.customer }}</div></td>
                                        <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                        <td><div class="transform-media">{{ item.item }}</div></td>
                                        <td><div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        <td><div class="transform-media">{{ order.status }}</div></td>
                                    </tr>
                                {% endfor %}
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
   </div>
   <div class="tab-pane" id="tue">
        <div class="table_set">
            {% if current_week_orders.2.count > 0 %}
                <table class="table">
                    <thead>
                        <tr>
                            <th class="order_table_th" style="width: 40%;">Name</th>
                            <th class="order_table_th" style="width: 10%;">Type</th>
                            <th class="order_table_th" style="width: 20%;">Item</th>
                            <th class="order_table_th" style="width: 20%;">Quantity</th>
                            <th class="order_table_th" style="width: 10%;">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in current_week_orders.2 %}
                            {% if order.items.count > 1 %}
                                <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                    <td><div class="transform-media">{{ order.customer }}</div></td>
                                    <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.item }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.item }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td><div class="transform-media">{{ order.status }}</div></td>
                                </tr>
                            {% else %}
                                {% for item in order.items.all%}
                                    <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                        <td><div class="transform-media">{{ order.customer }}</div></td>
                                        <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                        <td><div class="transform-media">{{ item.item }}</div></td>
                                        <td><div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        <td><div class="transform-media">{{ order.status }}</div></td>
                                    </tr>
                                {% endfor %}
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
   </div>
   <div class="tab-pane" id="wed">
        <div class="table_set">
            {% if current_week_orders.3.count > 0 %}
                <table class="table">
                    <thead>
                        <tr>
                            <th class="order_table_th" style="width: 40%;">Name</th>
                            <th class="order_table_th" style="width: 10%;">Type</th>
                            <th class="order_table_th" style="width: 20%;">Item</th>
                            <th class="order_table_th" style="width: 20%;">Quantity</th>
                            <th class="order_table_th" style="width: 10%;">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in current_week_orders.3 %}
                            {% if order.items.count > 1 %}
                                <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                    <td><div class="transform-media">{{ order.customer }}</div></td>
                                    <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.item }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.item }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td><div class="transform-media">{{ order.status }}</div></td>
                                </tr>
                            {% else %}
                                {% for item in order.items.all%}
                                    <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                        <td><div class="transform-media">{{ order.customer }}</div></td>
                                        <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                        <td><div class="transform-media">{{ item.item }}</div></td>
                                        <td><div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        <td><div class="transform-media">{{ order.status }}</div></td>
                                    </tr>
                                {% endfor %}
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
   </div>
   <div class="tab-pane" id="thu">
        <div class="table_set">
            {% if current_week_orders.4.count > 0 %}
                <table class="table">
                    <thead>
                        <tr>
                            <th class="order_table_th" style="width: 40%;">Name</th>
                            <th class="order_table_th" style="width: 10%;">Type</th>
                            <th class="order_table_th" style="width: 20%;">Item</th>
                            <th class="order_table_th" style="width: 20%;">Quantity</th>
                            <th class="order_table_th" style="width: 10%;">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in current_week_orders.4 %}
                            {% if order.items.count > 1 %}
                                <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                    <td><div class="transform-media">{{ order.customer }}</div></td>
                                    <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.item }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.item }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td><div class="transform-media">{{ order.status }}</div></td>
                                </tr>
                            {% else %}
                                {% for item in order.items.all%}
                                    <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                        <td><div class="transform-media">{{ order.customer }}</div></td>
                                        <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                        <td><div class="transform-media">{{ item.item }}</div></td>
                                        <td><div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        <td><div class="transform-media">{{ order.status }}</div></td>
                                    </tr>
                                {% endfor %}
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
   </div>
   <div class="tab-pane" id="fri">
        <div class="table_set">
            {% if current_week_orders.5.count > 0 %}
                <table class="table">
                    <thead>
                        <tr>
                            <th class="order_table_th" style="width: 40%;">Name</th>
                            <th class="order_table_th" style="width: 10%;">Type</th>
                            <th class="order_table_th" style="width: 20%;">Item</th>
                            <th class="order_table_th" style="width: 20%;">Quantity</th>
                            <th class="order_table_th" style="width: 10%;">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in current_week_orders.5 %}
                            {% if order.items.count > 1 %}
                                <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                    <td><div class="transform-media">{{ order.customer }}</div></td>
                                    <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.item }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.item }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td><div class="transform-media">{{ order.status }}</div></td>
                                </tr>
                            {% else %}
                                {% for item in order.items.all%}
                                    <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                        <td><div class="transform-media">{{ order.customer }}</div></td>
                                        <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                        <td><div class="transform-media">{{ item.item }}</div></td>
                                        <td><div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        <td><div class="transform-media">{{ order.status }}</div></td>
                                    </tr>
                                {% endfor %}
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
   </div>
   <div class="tab-pane" id="sat">
        <div class="table_set">
            {% if current_week_orders.6.count > 0 %}
                <table class="table">
                    <thead>
                        <tr>
                            <th class="order_table_th" style="width: 40%;">Name</th>
                            <th class="order_table_th" style="width: 10%;">Type</th>
                            <th class="order_table_th" style="width: 20%;">Item</th>
                            <th class="order_table_th" style="width: 20%;">Quantity</th>
                            <th class="order_table_th" style="width: 10%;">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in current_week_orders.6 %}
                            {% if order.items.count > 1 %}
                                <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                    <td><div class="transform-media">{{ order.customer }}</div></td>
                                    <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.item }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.item }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td>
                                    {% for item in order.items.all %}
                                        {% if forloop.last %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        {% else %}
                                            <div class="transform-media">{{ item.quantity|intcomma }}</div>
                                        {% endif %}
                                    {% endfor %}
                                    <td><div class="transform-media">{{ order.status }}</div></td>
                                </tr>
                            {% else %}
                                {% for item in order.items.all%}
                                    <tr class="data_row" data-href="{% url 'order_detail' order.id %}">
                                        <td><div class="transform-media">{{ order.customer }}</div></td>
                                        <td><div class="transform-media">{{ order.transfer_type }}</div></td>
                                        <td><div class="transform-media">{{ item.item }}</div></td>
                                        <td><div class="transform-media">{{ item.quantity|intcomma }}</div></td>
                                        <td><div class="transform-media">{{ order.status }}</div></td>
                                    </tr>
                                {% endfor %}
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
   </div>
</div>

<script type="text/javascript">

    $(document).ready(function() {
        var options={
          format: 'm/d/yyyy',
          todayHighlight: true,
          autoclose: true,
        };
        $('#datepicker1').datepicker(options);
        let tday = '{% now "D" %}';
        $('.nav-link[href="#' + tday.toLowerCase() + '"]').tab('show');
        $('.data_row').click(function() {
            window.location = $(this).data('href');
            return false;
        });
    });

    $('#datepicker1').on('change', function() {
        if ($(this).val() != '') {
            var new_date = $(this).val();
            $.ajax({
                url: '{% url "update_week" %}',
                data: new_date,
                datatype: 'json',
                success: function(data) {
                }
            });
        }
    });

</script>

{% endblock %}